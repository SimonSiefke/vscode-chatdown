fileTypes: [chat]
name: Chatdown
patterns:
  - { include: "#frontMatter" }
  - { include: "#chat" }
repository:
  frontMatter:
    patterns:
      - match: "^(channelId)(=)\\s*([a-z]+)\\s*$"
        name: meta.frontmatter.chatdown
        captures:
          1:
            name: meta.frontmatter.key.chatdown
            patterns:
              - include: "#frontmatter.key"
          2:
            name: meta.frontmatter.separator.chatdown
          3:
            name: meta.frontmatter.value.chatdown
            patterns:
              - include: "#frontmatter.value"
      - match: "^(user|bot)(=)\\s*([a-zA-Z]+)\\s*$"
        name: meta.frontmatter.chatdown
        captures:
          1:
            name: meta.frontmatter.key.chatdown
            patterns:
              - include: "#frontmatter.key"
          2:
            name: meta.frontmatter.separator.chatdown
          3:
            name: meta.frontmatter.value.chatdown
            patterns:
              - include: "#frontmatter.value"
      - match: "^(users)(=)\\s*([a-zA-Z]+(,\\s*[a-zA-Z]+)*)\\s*$"
        name: meta.frontmatter.chatdown
        captures:
          1:
            name: meta.frontmatter.key.chatdown
            patterns:
              - include: "#frontmatter.key"
          2:
            name: meta.frontmatter.separator.chatdown
            patterns:
              - include: "#frontmatter.separator"
          3:
            name: meta.frontmatter.value.chatdown
            patterns:
              - include: "#frontmatter.value"
  frontmatter.key:
    patterns:
      - match: ".*"
        name: variable.other.chatdown
  frontmatter.separator:
    patterns:
      - match: ".*"
        name: keyword.operator.assignment.chatdown
  frontmatter.value:
    patterns:
      - match: "[a-zA-Z]+"
        name: string.unquoted.chatdown
      - match: ","
        name: punctuation.separator.chatdown
  chat:
    patterns:
      - begin: "^(?:(bot->(?!bot:)[a-zA-Z]+)|(bot)|([a-zA-Z]+))(:)"
        end: "^(?=(bot->[a-zA-Z]+:.*)|([a-zA-Z]+:.*))"
        name: meta.chat.chatdown
        beginCaptures:
          1:
            name: meta.chat.participant.directmessage.chatdown
            patterns:
              - match: "bot"
                name: meta.chat.participant.bot.chatdown
                captures:
                  0:
                    patterns:
                      - include: "#chat.participant.bot"
              - match: "->"
                name: meta.chat.separator.messageto.chatdown
                captures:
                  0:
                    patterns:
                      - include: "#chat.separator.messageto"
              - match: "[a-zA-Z]+"
                name: meta.chat.participant.user.chatdown
                captures:
                  0:
                    patterns:
                      - include: "#chat.participant.user"
          2:
            name: meta.chat.participant.bot.chatdown
            patterns:
              - include: "#chat.participant.bot"
          3:
            name: meta.chat.participant.user.chatdown
            patterns:
              - include: "#chat.participant.user"
          4:
            name: meta.chat.separator.chatdown
        patterns:
          - name: meta.chat.text.chatdown
            begin: "(?=[a-zA-Z\\s=:.]*)"
            end: "^(?=[.=]*)$"
            patterns:
              - include: "#chat.text"
  chat.participant.user:
    patterns:
      - match: ".*"
        name: markup.bold.chatdown
  chat.participant.bot:
    patterns:
      - match: ".*"
        name: markup.bold.chatdown
  chat.separator:
    patterns:
      - match: ".*"
        name: markup.bold.chatdown
  chat.separator.messageto:
    patterns:
      - match: ".*"
        name: markup.bold.chatdown
  chat.text:
    patterns:
      - match: ".*"
        name: meta.paragraph.markdown.chatdown
  # chat:
  #   patterns:
  #     - match: "^[a-zA-Z]+(?:(->)([a-zA-Z]+))?"
  #       captures:
  #         0:
  #           name: "entity.name.tag.chatdown"
  #         1:
  #           name: keyword.operator.to.chatdown
  #         2:
  #           name: "entity.name.tag.chatdown"
  #     - match: "([^:]+)(?=:)"
  #       name: invalid.illegal.expected-colon.chatdown
  #     - match: ":"
  #       name: "punctuation.separator.key-value.mapping.chatdown"
  #     - match: ".*$"
  #       name: "meta.structure.dictionary.value.json"
  #       captures:
  #         0:
  #           patterns:
  #             - include: "#value"
  # value:
  #   patterns:
  #     - begin: "\\["
  #       end: "\\]"
  #       beginCaptures:
  #         0:
  #           name: "punctuation.definition.array.begin.chatdown"
  #       endCaptures:
  #         0:
  #           name: "punctuation.definition.array.end.chatdown"
  #       name: "meta.structure.array"
  #       patterns:
  #         - include: "#insideArrayKeyValue"
  # insideArrayKeyValue:
  #   patterns:
  #     - match: "(Typing|Delay|ConversationUpdate)"
  #       name: "constant.language.chatdown"
  #     - match: "="
  #       name: punctuation.separator.key-value.mapping.chatdown
  #     - match: "\\w*"
  #       name: "meta.structure.dictionary.value.chatdown"
  #       captures:
  #         0:
  #           patterns:
  #             - include: "#number"
  #             - include: "#string"
  # number:
  #   patterns:
  #     - match: "(?<!\\w)(?:(0|[1-9]\\d*))"
  #       name: constant.numeric.chatdown
  # string:
  #   patterns:
  #     - match: "[a-zA-Z\\d]+"
  #       name: "string.unquoted.chatdown"
scopeName: source.chatdown
